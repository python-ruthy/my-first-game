<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heartbeat Doctor - Prototype</title>
    <style>
        body { margin: 0; background: #000; color: #00ff88; font-family: 'Courier New', monospace; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; overflow: hidden; transition: background 0.1s; }
        .flash { background: #004422 !important; }
        
        #game-ui { text-align: center; width: 100%; z-index: 10; }
        #bpm-display { font-size: 3rem; font-weight: bold; margin-bottom: 10px; text-shadow: 0 0 15px #00ff88; }
        
        /* 心電圖容器 */
        #monitor { width: 90%; height: 150px; border-top: 2px solid #333; border-bottom: 2px solid #333; position: relative; display: flex; align-items: center; justify-content: center; background: rgba(0, 20, 0, 0.5); }
        
        .line { position: absolute; width: 100%; height: 2px; background: #111; z-index: 1; }
        
        #heart-svg { width: 100px; height: 100px; fill: #ff2d55; filter: drop-shadow(0 0 20px #ff2d55); cursor: pointer; z-index: 5; transition: transform 0.05s; }
        
        #ecg-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }

        #message { display: none; text-align: center; padding: 40px; background: #000; border: 4px solid #00ff88; box-shadow: 0 0 30px #00ff88; position: absolute; z-index: 100; max-width: 80%; }
        .glitch-text { animation: pulse-text 1s infinite; font-size: 1.2rem; line-height: 2; }
        @keyframes pulse-text { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        
        .hint { color: #555; margin-top: 30px; font-size: 0.8rem; letter-spacing: 2px; }
    </style>
</head>
<body onclick="beat()">

<div id="game-ui">
    <div id="bpm-display">BPM: <span id="bpm-val">75</span></div>
    <div id="monitor">
        <div class="line"></div>
        <svg id="heart-svg" viewBox="0 0 32 32">
            <path d="M16 28.21s-1.49-1.39-4.63-4.28C6.07 18.99 2 15.36 2 10.5 2 6.36 5.36 3 9.5 3c2.49 0 4.74 1.21 6.12 3.08C17.01 4.21 19.26 3 21.5 3 25.64 3 29 6.36 29 10.5c0 4.86-4.07 8.49-9.37 13.43-3.14 2.89-4.63 4.28-4.63 4.28z"/>
        </svg>
    </div>
    <p class="hint">按節奏點擊螢幕進行同步</p>
</div>

<div id="message">
    <div class="glitch-text">
        <p>[ 警告：節奏完全失控 ]</p>
        <p>系統偵測到心跳異常異常...</p>
        <p>原因：對你的喜愛已超過負荷。</p>
        <p><b>這款遊戲的最後一關，</b></p>
        <p><b>是想問你，願意在一起嗎？</b></p>
    </div>
</div>

<audio id="bgm" loop>
    <source src="https://www.chosic.com/wp-content/uploads/2021/07/Rainy-Day.mp3" type="audio/mpeg">
</audio>

<script>
    let count = 0;
    let bpm = 75;
    const body = document.body;
    const bpmVal = document.getElementById('bpm-val');
    const heart = document.getElementById('heart-svg');
    const audio = document.getElementById('bg
